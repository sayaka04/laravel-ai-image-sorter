<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Log;

class TestingController extends Controller
{


    public function index(Request $request)
    {
        // // return response()->json(['status' => 'success', 'message' => 'TestingController is working!']);
        // $cachedResponse = $this->response;

        // $outer = json_decode($cachedResponse, true); // now it's an array

        // $innerJson = $outer['response']; // this is a JSON string
        // $inner = json_decode($innerJson, true); // now this is the actual data array

        // // Log the main fields
        // Log::info('LLM Response Summary', [
        //     'category_id'      => $inner['category_id'],
        //     'confidence_score' => $inner['confidence_score'],
        //     'reasoning'        => $inner['reasoning'],
        //     'summary'          => $inner['summary'],
        // ]);

        // // Log the extracted data
        // Log::info('LLM Extracted Data', [
        //     'date'   => $inner['extracted_data']['date'],
        //     'amount' => $inner['extracted_data']['amount'],
        //     'sender' => $inner['extracted_data']['sender'],
        // ]);

        // // Log the suggested action
        // Log::info('LLM Suggested Action', [
        //     'type'   => $inner['suggested_action']['type'],
        //     'label'  => $inner['suggested_action']['label'],
        //     'detail' => $inner['suggested_action']['detail'],
        // ]);


        return response()->json(['status' => 'success', 'message' => 'TestingController is working!']);
    }


    public $response = '{
    "model": "llama3.1:latest",
    "created_at": "2026-01-29T16:14:42.9166696Z",
    "response": "{\n  \"category_id\": 4,\n  \"confidence_score\": 0.95,\n  \"summary\": \"The image contains handwritten text.\",\n  \"reasoning\": \"The presence of casual, personal handwriting and the absence of logos or graphical elements point towards a Hand Writing category.\",\n  \"extracted_data\": {\n    \"date\": null,\n    \"amount\": null,\n    \"sender\": null\n  },\n  \"suggested_action\": {\n    \"type\": \"archive\",\n    \"label\": \"Archive as Hand Writing\",\n    \"detail\": \"Place in designated Hand Writing folder for further categorization or review.\"\n  }\n}",
    "done": true,
    "done_reason": "stop",
    "context": [
        128006,
        882,
        128007,
        271,
        2675,
        527,
        16147,
        10442,
        261,
        15592,
        11,
        459,
        6335,
        5438,
        80244,
        323,
        4443,
        18328,
        627,
        2675,
        690,
        5371,
        459,
        2217,
        4096,
        8066,
        555,
        2500,
        15592,
        382,
        7927,
        3465,
        374,
        311,
        8356,
        3146,
        790,
        40577,
        4823,
        27785,
        334,
        627,
        2822,
        41941,
        13,
        2360,
        51594,
        13,
        2360,
        5066,
        1495,
        382,
        14711,
        68819,
        356,
        67696,
        512,
        12,
        3110,
        220,
        16,
        25,
        330,
        16047,
        1,
        320,
        27099,
        25,
        3331,
        29373,
        340,
        12,
        3110,
        220,
        17,
        25,
        330,
        68561,
        82,
        1,
        320,
        27099,
        25,
        3331,
        29373,
        340,
        12,
        3110,
        220,
        18,
        25,
        330,
        19933,
        1147,
        1,
        320,
        27099,
        25,
        3331,
        29373,
        340,
        12,
        3110,
        220,
        19,
        25,
        330,
        2367,
        24838,
        1,
        320,
        27099,
        25,
        3331,
        29373,
        340,
        12,
        3110,
        220,
        20,
        25,
        330,
        28683,
        1,
        320,
        27099,
        25,
        3331,
        29373,
        340,
        12,
        3110,
        220,
        15,
        25,
        330,
        64818,
        58711,
        1,
        320,
        10464,
        1193,
        422,
        4400,
        18809,
        696,
        14711,
        34769,
        33285,
        512,
        517,
        262,
        330,
        2590,
        794,
        330,
        80,
        17378,
        18,
        8437,
        75,
        25,
        19,
        65,
        761,
        262,
        330,
        7266,
        3837,
        794,
        330,
        2366,
        21,
        12,
        1721,
        12,
        1682,
        51,
        845,
        25,
        2318,
        25,
        1272,
        13,
        14777,
        20165,
        20,
        57,
        761,
        262,
        330,
        2037,
        794,
        341,
        286,
        330,
        5898,
        794,
        330,
        78191,
        761,
        286,
        330,
        1834,
        794,
        6660,
        3146,
        94595,
        1495,
        96618,
        7393,
        2465,
        836,
        2153,
        389,
        279,
        1176,
        1584,
        11,
        7393,
        285,
        2153,
        389,
        279,
        2132,
        1584,
        11,
        323,
        7393,
        13379,
        0,
        2153,
        389,
        279,
        4948,
        1584,
        13,
        220,
        1144,
        77,
        12,
        3146,
        11804,
        11,
        50119,
        11,
        477,
        99489,
        8554,
        96618,
        578,
        2217,
        5727,
        1193,
        99489,
        1495,
        13,
        2360,
        50119,
        11,
        18210,
        11,
        477,
        54243,
        5540,
        527,
        3118,
        13,
        578,
        1495,
        8111,
        311,
        387,
        264,
        16736,
        11,
        4443,
        5296,
        13,
        220,
        1144,
        77,
        12,
        3146,
        2224,
        323,
        2317,
        96618,
        578,
        1495,
        374,
        28902,
        304,
        2380,
        12414,
        5238,
        11,
        449,
        912,
        13263,
        17632,
        13,
        7393,
        2465,
        836,
        2153,
        374,
        5439,
        304,
        43147,
        449,
        264,
        16736,
        5429,
        11,
        7393,
        285,
        2153,
        374,
        43147,
        323,
        10284,
        1280,
        16243,
        11,
        1418,
        7393,
        13379,
        0,
        2153,
        374,
        98421,
        320,
        4291,
        264,
        3544,
        11,
        14265,
        7393,
        41,
        63805,
        323,
        10548,
        449,
        459,
        506,
        34084,
        1906,
        13,
        578,
        4092,
        374,
        264,
        6573,
        11,
        14733,
        4251,
        7479,
        11,
        23377,
        264,
        4382,
        11,
        653,
        329,
        1540,
        291,
        4477,
        7479,
        320,
        68,
        1326,
        2637,
        264,
        38266,
        2199,
        477,
        5684,
        570,
        220,
        1144,
        77,
        12,
        3146,
        11663,
        9302,
        43775,
        96618,
        578,
        92809,
        50829,
        9099,
        42408,
        1385,
        14595,
        315,
        42887,
        4477,
        320,
        68,
        1326,
        2637,
        61437,
        27032,
        1990,
        12197,
        11,
        8275,
        1776,
        519,
        570,
        578,
        27513,
        374,
        78909,
        3776,
        11,
        449,
        912,
        9621,
        10651,
        477,
        59617,
        13,
        578,
        506,
        34084,
        1906,
        1306,
        7393,
        13379,
        0,
        2153,
        374,
        10284,
        74117,
        11,
        19392,
        25679,
        13,
        2684,
        527,
        912,
        66251,
        5540,
        320,
        68,
        1326,
        2637,
        45543,
        11,
        24743,
        8,
        311,
        4284,
        264,
        3230,
        6376,
        477,
        7580,
        7953,
        279,
        5224,
        315,
        9764,
        10560,
        286,
        330,
        83360,
        794,
        330,
        33562,
        433,
        11,
        1095,
        596,
        24564,
        279,
        2217,
        3094,
        555,
        3094,
        13,
        5629,
        11,
        358,
        1205,
        311,
        1427,
        520,
        279,
        81677,
        1495,
        13,
        578,
        2217,
        706,
        99489,
        1495,
        13,
        6914,
        596,
        1373,
        1855,
        961,
        13,
        578,
        1176,
        1584,
        374,
        7393,
        2465,
        836,
        16613,
        1243,
        279,
        2132,
        1584,
        374,
        7393,
        285,
        3842,
        0,
        2153,
        13,
        14144,
        11,
        1095,
        596,
        1817,
        279,
        27032,
        13,
        578,
        4339,
        25,
        7393,
        2465,
        836,
        2153,
        389,
        279,
        1176,
        1584,
        11,
        1243,
        7393,
        285,
        2153,
        389,
        279,
        2132,
        1584,
        11,
        323,
        7393,
        13379,
        0,
        2153,
        389,
        279,
        1828,
        1584,
        13,
        14144,
        11,
        279,
        92809,
        25,
        7393,
        2465,
        836,
        2153,
        374,
        304,
        43147,
        11,
        7393,
        285,
        2153,
        374,
        1101,
        43147,
        11,
        7393,
        13379,
        0,
        2153,
        706,
        264,
        6864,
        622,
        323,
        459,
        506,
        34084,
        1906,
        7255,
        77,
        1734,
        7184,
        11,
        6302,
        477,
        50119,
        25,
        1070,
        527,
        912,
        50119,
        11,
        1120,
        99489,
        1495,
        13,
        578,
        1495,
        374,
        5439,
        304,
        264,
        16736,
        11,
        42887,
        5429,
        13,
        578,
        6932,
        25,
        433,
        596,
        264,
        4382,
        11,
        12414,
        27204,
        13,
        9062,
        3492,
        374,
        389,
        264,
        8821,
        1584,
        11,
        719,
        539,
        14268,
        27210,
        13,
        6914,
        596,
        1518,
        279,
        10093,
        13,
        7393,
        2465,
        836,
        2153,
        374,
        4762,
        279,
        1176,
        1584,
        11,
        31288,
        477,
        2163,
        98551,
        13,
        5112,
        7393,
        285,
        2153,
        374,
        389,
        279,
        1828,
        1584,
        11,
        7344,
        264,
        2766,
        1280,
        16243,
        13,
        5112,
        7393,
        13379,
        0,
        2153,
        374,
        389,
        279,
        4948,
        1584,
        11,
        902,
        5084,
        311,
        387,
        279,
        1925,
        836,
        13,
        578,
        506,
        34084,
        1906,
        374,
        520,
        279,
        842,
        315,
        7393,
        13379,
        0,
        2153,
        7255,
        77,
        1734,
        9789,
        43775,
        25,
        279,
        4092,
        374,
        14733,
        4251,
        11,
        912,
        1023,
        5540,
        13,
        578,
        4477,
        374,
        304,
        3776,
        11,
        11000,
        27513,
        13,
        578,
        92809,
        1742,
        374,
        264,
        2766,
        46946,
        11,
        449,
        1063,
        1776,
        519,
        11,
        719,
        433,
        596,
        264,
        4443,
        5296,
        13,
        10926,
        264,
        1716,
        596,
        4477,
        30,
        578,
        12197,
        527,
        539,
        14268,
        14454,
        11,
        902,
        374,
        4279,
        304,
        16736,
        4477,
        13,
        6914,
        596,
        1160,
        1855,
        3777,
        7338,
        77,
        1734,
        94595,
        1495,
        25,
        7393,
        2465,
        836,
        2153,
        389,
        279,
        1176,
        1584,
        11,
        7393,
        285,
        2153,
        389,
        279,
        2132,
        11,
        7393,
        13379,
        0,
        2153,
        389,
        279,
        4948,
        13,
        14144,
        11,
        1095,
        596,
        1817,
        279,
        4839,
        1495,
        13,
        578,
        2217,
        5039,
        7338,
        77,
        1734,
        5451,
        1584,
        25,
        7393,
        2465,
        836,
        23041,
        77,
        16041,
        1584,
        25,
        7393,
        285,
        3842,
        0,
        2153,
        1144,
        84,
        679,
        19,
        3868,
        11,
        912,
        13,
        14144,
        11,
        3411,
        520,
        279,
        2217,
        25,
        279,
        2132,
        1584,
        374,
        7393,
        285,
        16613,
        323,
        279,
        4948,
        1584,
        374,
        7393,
        13379,
        0,
        2153,
        13,
        14144,
        11,
        304,
        279,
        4113,
        2217,
        11,
        279,
        1495,
        374,
        7338,
        77,
        1734,
        2465,
        836,
        1734,
        285,
        3842,
        15114,
        77,
        1734,
        9642,
        11,
        430,
        596,
        1268,
        433,
        596,
        5439,
        13,
        2100,
        279,
        2539,
        1495,
        374,
        7393,
        2465,
        836,
        3505,
        26209,
        3842,
        0,
        2153,
        320,
        4291,
        264,
        40127,
        1990,
        7393,
        609,
        2153,
        323,
        7393,
        285,
        16613,
        719,
        279,
        7393,
        285,
        2153,
        374,
        389,
        279,
        1828,
        1584,
        11,
        1243,
        7393,
        13379,
        0,
        2153,
        389,
        279,
        4948,
        1584,
        73441,
        77,
        1734,
        11804,
        25,
        7000,
        11,
        1120,
        1495,
        13,
        8704,
        26650,
        8554,
        25,
        10035,
        11,
        264,
        4443,
        5296,
        28898,
        279,
        836,
        7255,
        77,
        1734,
        2224,
        25,
        2380,
        5238,
        315,
        1495,
        13,
        5629,
        1584,
        25,
        7393,
        2465,
        836,
        2153,
        320,
        2414,
        98551,
        11,
        43147,
        570,
        10657,
        1584,
        25,
        7393,
        285,
        2153,
        320,
        3133,
        291,
        477,
        2163,
        98551,
        11,
        43147,
        570,
        21530,
        1584,
        25,
        7393,
        13379,
        0,
        2153,
        320,
        3133,
        291,
        11,
        40582,
        622,
        11,
        506,
        34084,
        1906,
        570,
        578,
        4477,
        706,
        1063,
        42408,
        27032,
        11,
        719,
        279,
        5238,
        527,
        42415,
        52035,
        7255,
        77,
        1734,
        11663,
        9302,
        43775,
        25,
        279,
        4092,
        374,
        264,
        14733,
        4251,
        7479,
        11,
        912,
        24743,
        477,
        1023,
        5540,
        13,
        578,
        27513,
        374,
        6573,
        3776,
        11,
        912,
        72834,
        13,
        578,
        4477,
        374,
        2884,
        449,
        264,
        5869,
        11,
        4461,
        264,
        5041,
        2837,
        477,
        4528,
        11,
        439,
        279,
        5238,
        527,
        13263,
        13,
        578,
        506,
        34084,
        1906,
        374,
        10284,
        8294,
        11,
        902,
        374,
        14595,
        304,
        99489,
        1495,
        369,
        25679,
        13,
        578,
        3492,
        7393,
        13379,
        2153,
        706,
        264,
        6864,
        622,
        11,
        902,
        374,
        279,
        1212,
        315,
        279,
        836,
        11,
        779,
        433,
        596,
        24001,
        439,
        264,
        6300,
        38021,
        13,
        578,
        4261,
        374,
        12860,
        555,
        459,
        506,
        34084,
        1906,
        11,
        902,
        2643,
        13519,
        28361,
        477,
        264,
        4443,
        5916,
        10246,
        262,
        1173,
        262,
        330,
        10655,
        794,
        837,
        345,
        262,
        330,
        10655,
        39329,
        794,
        330,
        9684,
        761,
        262,
        330,
        5143,
        26532,
        794,
        220,
        17574,
        24487,
        24758,
        3443,
        345,
        262,
        330,
        1096,
        26532,
        794,
        220,
        22642,
        23309,
        24388,
        410,
        345,
        262,
        330,
        41681,
        22001,
        3259,
        794,
        220,
        3965,
        345,
        262,
        330,
        41681,
        22001,
        26532,
        794,
        220,
        11286,
        24777,
        11123,
        410,
        345,
        262,
        330,
        14504,
        3259,
        794,
        220,
        17000,
        345,
        262,
        330,
        14504,
        26532,
        794,
        220,
        16884,
        11739,
        18252,
        2636,
        198,
        633,
        14711,
        44079,
        50,
        512,
        16,
        13,
        38527,
        3059,
        279,
        2217,
        4096,
        15884,
        627,
        17,
        13,
        22991,
        279,
        3146,
        15698,
        1888,
        10260,
        3110,
        334,
        627,
        18,
        13,
        21335,
        264,
        832,
        1355,
        18886,
        2944,
        627,
        19,
        13,
        328,
        3884,
        279,
        1828,
        1888,
        1957,
        382,
        14711,
        77273,
        53325,
        320,
        3337,
        6966,
        4823,
        997,
        517,
        220,
        330,
        5588,
        851,
        794,
        220,
        15,
        345,
        220,
        330,
        83029,
        10622,
        794,
        220,
        15,
        345,
        220,
        330,
        1743,
        794,
        8488,
        220,
        330,
        20489,
        287,
        794,
        8488,
        220,
        330,
        24396,
        291,
        1807,
        794,
        341,
        262,
        330,
        1045,
        794,
        854,
        345,
        262,
        330,
        6173,
        794,
        854,
        345,
        262,
        330,
        11905,
        794,
        854,
        198,
        220,
        1173,
        220,
        330,
        82,
        54376,
        8090,
        794,
        341,
        262,
        330,
        1337,
        794,
        330,
        16402,
        761,
        262,
        330,
        1530,
        794,
        8488,
        262,
        330,
        14927,
        794,
        8555,
        220,
        457,
        92,
        128009,
        128006,
        78191,
        128007,
        271,
        517,
        220,
        330,
        5588,
        851,
        794,
        220,
        19,
        345,
        220,
        330,
        83029,
        10622,
        794,
        220,
        15,
        13,
        2721,
        345,
        220,
        330,
        1743,
        794,
        330,
        791,
        2217,
        5727,
        99489,
        1495,
        10560,
        220,
        330,
        20489,
        287,
        794,
        330,
        791,
        9546,
        315,
        16736,
        11,
        4443,
        92809,
        323,
        279,
        19821,
        315,
        50119,
        477,
        54243,
        5540,
        1486,
        7119,
        264,
        8704,
        24838,
        5699,
        10560,
        220,
        330,
        24396,
        291,
        1807,
        794,
        341,
        262,
        330,
        1045,
        794,
        854,
        345,
        262,
        330,
        6173,
        794,
        854,
        345,
        262,
        330,
        11905,
        794,
        854,
        198,
        220,
        1173,
        220,
        330,
        82,
        54376,
        8090,
        794,
        341,
        262,
        330,
        1337,
        794,
        330,
        16402,
        761,
        262,
        330,
        1530,
        794,
        330,
        43602,
        439,
        8704,
        24838,
        761,
        262,
        330,
        14927,
        794,
        330,
        17826,
        304,
        24073,
        8704,
        24838,
        8695,
        369,
        4726,
        22824,
        2065,
        477,
        3477,
        10246,
        220,
        457,
        92
    ],
    "total_duration": 359600920300,
    "load_duration": 20314611100,
    "prompt_eval_count": 1379,
    "prompt_eval_duration": 253842845700,
    "eval_count": 131,
    "eval_duration": 85143380800
}  
';
}
